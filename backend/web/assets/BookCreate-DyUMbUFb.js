import{_ as B,k as P,b as r,c as i,d as k,f as o,g as s,F as D,l as y,r as U,u as $,o as A,m as S,n as I,p as C,e as v,h as w,i as N,a as R,j as V,q,s as G,v as T,x as j,y as z}from"./index-DS7EhqvI.js";const E=P({components:{},props:{},setup(){const e=y({formData:{book_name:"",grade_id:"",publish:"",book_image:""},options:[],rules:{}}),a=y({token:"",crc32:"",accept:""});U("");const p=z(),g=N(),m=$(),h=()=>{p.proxy.$refs.vForm.validate(t=>{t&&R({url:"/v1/learn/book/create",headers:{Accept:"application/json","X-Api-Key":m.getToken()},method:"post",data:e.formData}).then(function(l){l.data.status==200&&l.data.code==0&&(u(),g.push("/book")),V(l.data.message)})})},u=()=>{p.proxy.$refs.vForm.resetFields()},d=(t,l)=>{console.log(t),e.formData.book_image="http://satx0rnad.hn-bkt.clouddn.com/"+t.key},c=()=>{console.log("handlePictureCardPreview")},f=()=>{console.log("handleRemove")},b=t=>{console.log("beforeAvatarUpload");let l=q();return console.log(l),a.token=l.token,!0},_=()=>{G({url:"/v1/learn/grade/index",method:"get"},function(t){t.code==0?e.options=t.data:V(t.message)})};return A(()=>{_()}),{...S(e),submitForm:h,resetForm:u,handleAvatarSuccess:d,handlePictureCardPreview:c,beforeAvatarUpload:b,handleRemove:f,userStore:m,uploadData:a}}}),L=e=>(T("data-v-b20bed8e"),e=e(),j(),e),M=L(()=>v("div",{style:{"border-bottom":"solid 1px #b1b3b8","margin-bottom":"10px","padding-bottom":"10px"}},[v("span",null,"Create New Book")],-1)),K=["src"],X={class:"static-content-item"};function x(e,a,p,g,m,h){const u=r("el-input"),d=r("el-form-item"),c=r("el-option"),f=r("el-select"),b=r("Plus"),_=r("el-icon"),t=r("el-upload"),l=r("el-button"),F=r("el-form");return i(),k(D,null,[M,o(F,{model:e.formData,ref:"vForm",rules:e.rules,"label-position":"left","label-width":"150px",size:"default"},{default:s(()=>[o(d,{label:"Book Name",prop:"book_name"},{default:s(()=>[o(u,{modelValue:e.formData.book_name,"onUpdate:modelValue":a[0]||(a[0]=n=>e.formData.book_name=n),type:"text",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"Grade",prop:"grade_id"},{default:s(()=>[o(f,{modelValue:e.formData.grade_id,"onUpdate:modelValue":a[1]||(a[1]=n=>e.formData.grade_id=n),placeholder:"Grade",style:{width:"240px"}},{default:s(()=>[(i(!0),k(D,null,I(e.options,n=>(i(),C(c,{key:n.id,label:n.grade_name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"Publish",prop:"publish"},{default:s(()=>[o(u,{modelValue:e.formData.publish,"onUpdate:modelValue":a[2]||(a[2]=n=>e.formData.publish=n),type:"text",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"Book Image",prop:"book_image"},{default:s(()=>[o(t,{name:"file",action:"http://up-z2.qiniup.com",data:e.uploadData,class:"avatar-uploader","show-file-list":!1,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"list-type":"picture-card"},{default:s(()=>[e.formData.book_image?(i(),k("img",{key:0,src:e.formData.book_image,class:"avatar",width:"148",height:"148"},null,8,K)):(i(),C(_,{key:1,class:"avatar-uploader-icon"},{default:s(()=>[o(b)]),_:1}))]),_:1},8,["data","on-preview","on-remove","on-success","before-upload"])]),_:1}),v("div",X,[o(l,{onClick:e.submitForm},{default:s(()=>[w("Create")]),_:1},8,["onClick"]),o(l,{onClick:a[3]||(a[3]=n=>e.$router.push({name:"book"}))},{default:s(()=>[w("Back")]),_:1})])]),_:1},8,["model","rules"])],64)}const J=B(E,[["render",x],["__scopeId","data-v-b20bed8e"]]);export{J as default};
